<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>code.FLY-SMOTE-CCMCB.main</title>
    <meta name="generator" content="pydoctor 24.11.2"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="readthedocstheme.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
    
</head>

  <body>

    

    <nav class="navbar navbar-default mainnavbar">
      
  
  <div class="container-fluid">


    <div class="navbar-header">
      
      <div class="navlinks">
        <span class="navbar-brand">
          FLY-SMOTE-CCMCB <a href="index.html">API Documentation</a>
        </span>

        <a href="moduleIndex.html">
          Modules
        </a>

        <a href="classIndex.html">
          Classes
        </a>

        <a href="nameIndex.html">
          Names
        </a>

        <div id="search-box-container">
          <div class="input-group">
            <input id="search-box" type="search" name="search-query" placeholder="Search..." aria-label="Search" minlength="2" class="form-control" autocomplete="off" />
            
            <span class="input-group-btn">
              <a style="display: none;" class="btn btn-default" id="search-clear-button" title="Clear" onclick="clearSearch()"><img src="fonts/x-circle.svg" alt="Clear" /></a>
              <a class="btn btn-default" id="apidocs-help-button" title="Help" href="apidocs-help.html"><img src="fonts/info.svg" alt="Help" /></a>
            </span>
          </div>
        </div>

      </div>

      <div id="search-results-container" style="display: none;">
        
        <div id="search-buttons">
          <span class="label label-default" id="search-docstrings-button">
          <label class="checkbox-inline">
            <input type="checkbox" id="toggle-search-in-docstrings-checkbox" value="false" onclick="toggleSearchInDocstrings()">
              search in docstrings
            </input>
          </label>
          </span>
          
        </div>
        
        <noscript>
            <h1>Cannot search: JavaScript is not supported/enabled in your browser.</h1>
        </noscript>

        <div id="search-status"> </div>

        <div class="warning" id="search-warn-box" style="display: none;">
          <p class="rst-last"><span id="search-warn"></span></p>
        </div>

        <table id="search-results">
          <!-- Filled dynamically by JS -->
        </table>
        
        <div style="margin-top: 10px;">
          <p>For more information on the search, visit the <a href="apidocs-help.html#rst-search">help page</a>.</p>
        </div>
      </div>

    </div>


  </div>

    
        <!-- Side navigation -->
      <div class="sidebarcontainer">
        <nav class="sidebar">
  

  <div>

      <div class="thingTitle">
        <span>Module</span>
        <code class="thisobject"><a href="code.FLY-SMOTE-CCMCB.main.html" class="internal-link" title="This module">main</a></code> 
      </div>
      
      <div>
        

        
         

        
        

        <div class="childrenKindTitle">Functions</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="#run" class="internal-link" title="code.FLY-SMOTE-CCMCB.main.run">run</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_cross_validation" class="internal-link" title="code.FLY-SMOTE-CCMCB.main._cross_validation">_cross<wbr></wbr>_validation</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_evaluate" class="internal-link" title="code.FLY-SMOTE-CCMCB.main._evaluate">_evaluate</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_fl_loop" class="internal-link" title="code.FLY-SMOTE-CCMCB.main._fl_loop">_fl<wbr></wbr>_loop</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_gan_loop" class="internal-link" title="code.FLY-SMOTE-CCMCB.main._gan_loop">_gan<wbr></wbr>_loop</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_train" class="internal-link" title="code.FLY-SMOTE-CCMCB.main._train">_train</a></code>
            </div>
        

    </li>
</ul> 

        
         

        <div class="childrenKindTitle">Variables</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="#logger" class="internal-link" title="code.FLY-SMOTE-CCMCB.main.logger">logger</a></code>
            </div>
        

    </li>
</ul> 

        
         
        
      </div>
  </div><div>

      <div class="thingTitle">
        <span>Package</span>
        <code><a href="code.FLY-SMOTE-CCMCB.html" class="internal-link" title="The parent of this module">FLY-SMOTE-CCMCB</a></code> 
      </div>
      
      <div>
        

        <div class="childrenKindTitle">Modules</div>
        <ul>
    
    <li class=" thisobject">
        
        
        

        
            <div class="itemName"><code><a href="code.FLY-SMOTE-CCMCB.main.html" class="internal-link" title="code.FLY-SMOTE-CCMCB.main">main</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="code.FLY-SMOTE-CCMCB.utils.html" class="internal-link" title="code.FLY-SMOTE-CCMCB.utils">utils</a></code>
            </div>
        

    </li>
</ul> 

        
        

        
         

        
         

        
         

        
         
        
      </div>
  </div>

</nav>
        <!-- No sidebar toggle for read the docs theme, the sidebar is always
          visible when the screen is width enough.
        -->
      </div>

    </nav>
    
    <div class="container-fluid">

      <div id="main" class="">
        

        


        <div class="page-header">
          <h1 class="module"><code><code><a href="index.html" class="internal-link">code</a></code><wbr></wbr>.<code><a href="code.FLY-SMOTE-CCMCB.html" class="internal-link" title="code.FLY-SMOTE-CCMCB">FLY-SMOTE-CCMCB</a></code><wbr></wbr>.<code><a href="code.FLY-SMOTE-CCMCB.main.html" class="internal-link" title="code.FLY-SMOTE-CCMCB.main">main</a></code></code></h1>
          <div id="showPrivate">
            <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
          </div>
        </div>

        <div class="categoryHeader">
          module documentation
        </div>

        <div class="extrasDocstring">
          
          <p></p>
        </div>

        <div class="moduleDocstring">
          <div><p class="pre">Main module for the FLY-SMOTE-CCMCB project.

This module orchestrates the federated learning (FL) training and GAN training process for the FLY-SMOTE-CCMCB project.
It handles data loading, cross-validation, training, evaluation, and logging, including integration with W&amp;B for experiment tracking.

Functions:
    run: The entry point for the training and evaluation process.
    _train: The function that trains the model using federated learning and GAN.
    _evaluate: Evaluates the trained model's performance on the test set.
    _cross_validation: Executes k-fold cross-validation if enabled in the config.
    _gan_loop: A loop for training the GAN.
    _fl_loop: A loop for federated learning communication rounds.</p></div>
        </div>

        <div id="splitTables">
          <table class="children sortable" id="id3">
  
  
  <tr class="function">
    
    <td>Function</td>
    <td><code><a href="#run" class="internal-link" title="code.FLY-SMOTE-CCMCB.main.run">run</a></code></td>
    <td>Orchestrates the entire process of training and evaluating the model.</td>
  </tr><tr class="variable">
    
    <td>Variable</td>
    <td><code><a href="#logger" class="internal-link" title="code.FLY-SMOTE-CCMCB.main.logger">logger</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_cross_validation" class="internal-link" title="code.FLY-SMOTE-CCMCB.main._cross_validation">_cross<wbr></wbr>_validation</a></code></td>
    <td>Executes k-fold cross-validation on the training dataset.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_evaluate" class="internal-link" title="code.FLY-SMOTE-CCMCB.main._evaluate">_evaluate</a></code></td>
    <td>Evaluates the performance of the trained model on the test set.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_fl_loop" class="internal-link" title="code.FLY-SMOTE-CCMCB.main._fl_loop">_fl<wbr></wbr>_loop</a></code></td>
    <td>Performs federated learning training.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_gan_loop" class="internal-link" title="code.FLY-SMOTE-CCMCB.main._gan_loop">_gan<wbr></wbr>_loop</a></code></td>
    <td>Performs training for the GAN model.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_train" class="internal-link" title="code.FLY-SMOTE-CCMCB.main._train">_train</a></code></td>
    <td>Trains the model using a combination of GAN and federated learning.</td>
  </tr>
</table>
          

            
        </div>

        <div id="childList">
          <div class="basefunction">
  
  
  <a name="code.FLY-SMOTE-CCMCB.main.run">
    
  </a>
  <a name="run">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">run</span><span class="function-signature">()</span>:
    
    <a class="headerLink" href="#run" title="code.FLY-SMOTE-CCMCB.main.run">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Orchestrates the entire process of training and evaluating the model.

This function handles argument parsing, logging setup, dataset loading, cross-validation (if enabled),
training the model, evaluating the model on the test set, and logging results to W&amp;B.

Args:
    None

Returns:
    None</p></div>
  </div>
</div><div class="basevariable">
  
  
  <a name="code.FLY-SMOTE-CCMCB.main.logger">
    
  </a>
  <a name="logger">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">logger</span> =
    
    <a class="headerLink" href="#logger" title="code.FLY-SMOTE-CCMCB.main.logger">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basefunction private">
  
  
  <a name="code.FLY-SMOTE-CCMCB.main._cross_validation">
    
  </a>
  <a name="_cross_validation">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_cross_validation</span><span class="function-signature">(x_train, y_train, x_test, y_test, config, tqdm_logger)</span>:
    
    <a class="headerLink" href="#_cross_validation" title="code.FLY-SMOTE-CCMCB.main._cross_validation">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Executes k-fold cross-validation on the training dataset.

This function splits the data into k subsets, trains and evaluates the model on each fold,
and logs the results. It averages the results across all folds and logs the final results to W&amp;B.

Args:
    x_train (array-like): Training features.
    y_train (array-like): Training labels.
    x_test (array-like): Test features.
    y_test (array-like): Test labels.
    config (Namespace): Configuration object with hyperparameters.
    tqdm_logger (TqdmLogger): Logger for tqdm progress.

Returns:
    None</p></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="code.FLY-SMOTE-CCMCB.main._evaluate">
    
  </a>
  <a name="_evaluate">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_evaluate</span><span class="function-signature">(global_model, x_test, y_test, config)</span>:
    
    <a class="headerLink" href="#_evaluate" title="code.FLY-SMOTE-CCMCB.main._evaluate">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Evaluates the performance of the trained model on the test set.

This function calculates and logs the performance metrics of the model on the test dataset.
It also integrates with W&amp;B for logging the results if configured.

Args:
    global_model (Keras model): The trained global model.
    x_test (array-like): Test features.
    y_test (array-like): Test labels.
    config (Namespace): Configuration object with hyperparameters.

Returns:
    test_results (dict): Dictionary containing test results for the model.</p></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="code.FLY-SMOTE-CCMCB.main._fl_loop">
    
  </a>
  <a name="_fl_loop">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_fl_loop</span><span class="function-signature">(clients, global_gan, config, tqdm_logger, x_test, y_test)</span>:
    
    <a class="headerLink" href="#_fl_loop" title="code.FLY-SMOTE-CCMCB.main._fl_loop">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Performs federated learning training.

This function manages the communication rounds for federated learning,
updates the global model weights, and logs the test results after each round.

Args:
    clients (dict): Dictionary of client data.
    global_gan (ConditionalGAN or None): The global GAN (if CCMCB is enabled).
    config (Namespace): Configuration object with hyperparameters.
    tqdm_logger (TqdmLogger): Logger for tqdm progress.
    x_test (array-like): Test features.
    y_test (array-like): Test labels.

Returns:
    global_model (Keras model): The trained global model after federated learning.</p></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="code.FLY-SMOTE-CCMCB.main._gan_loop">
    
  </a>
  <a name="_gan_loop">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_gan_loop</span><span class="function-signature">(clients, config, tqdm_logger, x_test, y_test)</span>:
    
    <a class="headerLink" href="#_gan_loop" title="code.FLY-SMOTE-CCMCB.main._gan_loop">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Performs training for the GAN model.

This function manages the communication rounds for GAN training, updates the generator weights,
and logs the test results for the GAN after each round.

Args:
    clients (dict): Dictionary of client data.
    config (Namespace): Configuration object with hyperparameters.
    tqdm_logger (TqdmLogger): Logger for tqdm progress.
    x_test (array-like): Test features.
    y_test (array-like): Test labels.

Returns:
    global_gan (ConditionalGAN or None): The trained global GAN or None if GAN training is not enabled.</p></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="code.FLY-SMOTE-CCMCB.main._train">
    
  </a>
  <a name="_train">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_train</span><span class="function-signature">(x_train, y_train, x_val, y_val, config, tqdm_logger)</span>:
    
    <a class="headerLink" href="#_train" title="code.FLY-SMOTE-CCMCB.main._train">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Trains the model using a combination of GAN and federated learning.

This function orchestrates the training by distributing data to clients,
performing GAN training (if necessary), and executing federated learning (FL) rounds
to average weights from client models.

Args:
    x_train (array-like): Training features.
    y_train (array-like): Training labels.
    x_val (array-like): Validation features.
    y_val (array-like): Validation labels.
    config (Namespace): Configuration object with hyperparameters.
    tqdm_logger (TqdmLogger): Logger for tqdm progress.

Returns:
    global_model (Keras model): The trained global model.</p></div>
  </div>
</div>
        </div>
      
      </div>
    </div>

    <footer class="navbar navbar-default">
    <hr />
    
    
    <div class="container-fluid">
      <a href="index.html">API Documentation</a> for FLY-SMOTE-CCMCB,
    generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
      24.11.2 at 2025-02-28 21:05:08.
    </div>
    
    <script src="ajax.js" type="text/javascript"></script>
    <script src="searchlib.js" type="text/javascript"></script>
    <script src="search.js" type="text/javascript"></script>
  
  </footer>
  
    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>